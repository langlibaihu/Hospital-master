/*! 2016 Baidu Inc. All Rights Reserved */
define("search/search",["require","common/js/ajax","common/js/pagination","common/js/config"],function(require){return{init:function(){},docSuccess:!1,hosSuccess:!1,reDocSuccess:!1,reHosSuccess:!1,httpGet:function(e,t,n,i,a,r,o,s){o=o||{},o.pageType=o.pageType||"";var l=this,c=require("common/js/ajax"),d=require("common/js/pagination"),u=$.extend({},t,l.getFilterData(a));c({url:""+l.api+e,type:"get",datatype:"json",data:u,success:function(c){if(c&&c.data){if("doctor"==n&&c.data.doctorList)if(1==$(".container").attr("data-accuracy"))i=$(".doctor-info-box"),l.viewAccurateDoctorList(c.data,i),r=$(".pagers");else l.viewDoctorList(c.data,i),l.pageEvent(),l.docSuccess=!0;else if("hospital"==n&&c.data.hospitalList)l.viewHospitalList(c.data,i,o),l.pageEvent(),l.hosSuccess=!0;else if("relativeDoc"==n&&c.data.doctorList)l.excelDoctorList=c.data.doctorList,l.viewExcelDoctor(s),l.excelDoctorDomEvent(s),l.reDocSuccess=!0;else if("relativeHos"==n&&c.data.hospitalList)l.relativeHos(c.data,i),l.reHosSuccess=!0;if(c.data.total)if("doctor"==n||"hospital"==n)new d({total:c.data.total,pageSize:10,curPage:a,pagerContainer:r,callback:function(a){l.httpGet(e,t,n,i,a,r,o)}}).init()}},error:function(e){}})},excelDoctorList:[],createExcelDoctorDom:function(e,t){var n=this;if(this.excelDoctorList&&e>this.excelDoctorList.length)return $('<li style="display:none;"></li>');var i=[];if(e%t==1)i.push('<li class="doctor-first">');else i.push("<li>");return e--,i.push('<a href="'+decodeURIComponent(n.excelDoctorList[e].link)+'" target="_blank"><img src="'+n.excelDoctorList[e].avatar+'"></a>'),i.push('<div class="doctor-opacity"><p class="skill">擅长:&nbsp;'+n.excelDoctorList[e].skillIndexCut+"</p></div>"),i.push('<p><a target="_blank" href="'+decodeURIComponent(n.excelDoctorList[e].link)+'"><span>'+n.excelDoctorList[e].name+'</span></a>&nbsp;<span class="doctor-level">'+n.excelDoctorList[e].medTitle+"</span></p>"),i.push("<p>"+n.excelDoctorList[e].departName+"</p>"),i.push('<p title="'+n.excelDoctorList[e].hospitalName+'">'+n.excelDoctorList[e].hospitalNameCut+"</p>"),i.push('<p class="btn-appoint"><a target="_blank" href="'+decodeURIComponent(n.excelDoctorList[e].link)+'"><span>一键预约</span></a></p>'),i.push("</li>"),$(i.join("")).hover(function(){$(this).css("background-color","#f9f9f9"),$(this).find(".doctor-opacity").css("display","block"),$(this).find(".btn-appoint span").css({"background-color":"#0197f1","border-color":"#0197f1",color:"#fff"})},function(){$(this).css("background-color","#fff"),$(this).find(".doctor-opacity").css("display","none"),$(this).find(".btn-appoint span").css({"background-color":"#fbfbfb",color:"#333","border-color":"#e8e8e8"})})},viewExcelDoctor:function(e){if(this.excelDoctorList.length<=0)return void $("#excel-doctor-div").remove();else $("#excel-doctor-div").show();for(var t=$("#dictor-list-ul"),n=1;e>=n;n++){var i=this.createExcelDoctorDom(n,e);t.append(i)}},excelDoctorDomEvent:function(e){var t=this,n=1,i=$("#dictor-list-ul"),a=Math.floor(t.excelDoctorList.length/e)+(t.excelDoctorList.length%e>0);if(n!=a)$("#next-arrow").find("img").attr("src",$(this).data("src")),$("#pre-arrow").find("img").hover(function(){if(1!=n)$(this).css("cursor","pointer"),$(this).attr("src",$(this).data("srchover"))},function(){if(1!=n)$(this).attr("src",$(this).data("src"));else $(this).css("cursor","auto"),$(this).attr("src",$(this).data("gray"))}),$("#next-arrow").find("img").hover(function(){if(n!=a)$(this).css("cursor","pointer"),$(this).attr("src",$(this).data("srchover"))},function(){if(n!=a)$(this).attr("src",$(this).data("src"));else $(this).css("cursor","auto"),$(this).attr("src",$(this).data("gray"))}),$("#pre-arrow").click(function(){if(1==n)return!1;n--;for(var a=1;e>=a;a++)!function(n,a){setTimeout(function(){i.find("li:eq("+(n-1)+")").replaceWith(t.createExcelDoctorDom((a-1)*e+n,e))},50*n)}(a,n);if(1==n)$("#pre-arrow").find("img").trigger("mouseleave")}),$("#next-arrow").click(function(){if(n==a)return!1;for(var r=e;r>=1;r--)!function(n,a){setTimeout(function(){i.find("li:eq("+(n-1)+")").replaceWith(t.createExcelDoctorDom(a*e+n,e))},50*(e-n))}(r,n);if(n++,n==a)$("#next-arrow").find("img").trigger("mouseleave")})},src:function(){var e=$(".footer-box").data("src");return e}(),href:function(){var e=$(".footer-box").data("href");return e}(),api:function(){var e=$(".footer-box").data("api");return e}(),createDoctorStr:function(e,t){for(var n=this,i=e.length,a=0;i>a;a++){if(t.push('<li class="doctor-info-single">'),t.push('<div class="doctor-card clearfix">'),t.push('<div class="info-pic"><a href="'+e[a].link+'" target="_blank" ><img src="'+e[a].avatar+'"></div>'),t.push('<div class="infos">'),t.push('<div class="info-title" style="margin-top:-10px\x00">'),t.push('<a href="'+e[a].link+'"  target="_blank"><div>'+e[a].name+"</div></a>"),0!=e[a].isVerify)t.push('<a href="'+e[a].verifyLink+'" target="_blank"><i><img src="'+n.src+'/common/img/fill_icon_doctor-yi.png"/></i><span>百度认证医生</span></a>');if("hdf"==e[a].siteFrom)t.push('<p class="res-verify"><img src="'+n.src+'/common/img/detail/icon_haodaifu.png"/><span>好大夫在线认证</span></p>');if(t.push('<span class="doctor-medtitle">'+e[a].medTitle+"</span>"),e[a].medTitle&&e[a].eduTitle)t.push("/");if(t.push('<span class="doctor-title">'+e[a].eduTitle+"</span>"),t.push('<p class="info-hospittal"><span><a href="'+e[a].hospitalLink+'" target="_blank" >'+e[a].hospitalName+'</a></span><a href="'+e[a].departLink+'" target="_blank" >'+e[a].departName+"</a></p>"),t.push("<table cellSpacing=0 cellPadding=0>"),t.push('<tr class="doctor-good">'),t.push('<td class="first-td" valign="top">擅长诊治: </td>'),t.push('<td class="last-td" valign="top">'+e[a].skill+"</td>"),t.push("</tr>"),t.push("</table>"),t.push('<div class="rate">'),e[a].star>0){t.push("<span>总推荐度：</span>"),t.push('<div class="grade-star">');for(var r=.5;10>r;){if(e[a].star>r+1)t.push('<i class="star-right star-light star-fixed"></i>');else if(e[a].star>r)t.push('<i class="star-right star-gray-light star-fixed"></i>');else t.push('<i class="star-right star-gray star-fixed"></i>');r+=2}t.push("</div>")}if(t.push("</div>"),t.push("</div>"),t.push("</div>"),t.push('<div class="server-but fr">'),e[a].serviceConsult)t.push('<p><a href="'+e[a].serviceConsult+'" target="_blank">咨询医生</a></p>');if(e[a].serviceOrder)t.push('<p><a href="'+e[a].serviceOrder+'" target="_blank">预约挂号</a></p>');t.push("</div>"),t.push("</div>"),t.push("</li>")}},viewDoctorList:function(e,t){var n=this;$("#doc_total").html(e.total);var i=[],a=e.doctorList.length;if(0>=a)t.parents(".doctor-info-box").find(".pagination-x").hide(),t.hide(),$(".doctor-empty").show();else{$(".doctor-empty").hide(),t.show(),t.parents(".doctor-info-box").find(".pagination-x").show(),n.createDoctorStr(e.doctorList,i),t.html(i.join("")).show(),t.find(".doctor-info-single").last().css("border-bottom","1px solid #eaeaea !important"),t.find(".doctor-info-single").hover(function(){$(this).css("border","1px solid #60afff"),$(this).next().css("border-top","none")},function(){if($(this).css("border-top","1px solid #eaeaea"),$(this).css("border-right","1px solid #fff"),$(this).css("border-left","1px solid #fff"),$(this).css("border-bottom","none"),$(this).next().css("border-top","1px solid #eaeaea"),$(this).index()==t.find(".doctor-info-single").length-1)$(this).css("border-bottom","1px solid #eaeaea")});var r=parseInt(a/10);if(0==r)$("#doctor-info-list").find(".doctor-info-single").eq(-1).css("border-bottom-color","#fff")}},viewAccurateDoctorList:function(e,t){var n=this,i=e.doctorList.length?e.doctorList.length:0,a=[];if(e.accurateDoctorList&&e.accurateDoctorList.length>0){if(e.accurateDoctorNumber>1)a.push('<h4>符合条件的 <font class="curdotor"><i id="total">'+e.total+"</i></font> 名优质医生</h4>");else a.push('<h4>符合条件的 <font class="curdotor"><i id="total">'+e.accurateDoctorNumber+"</i></font> 名优质医生</h4>");a.push('<ul class="doctor-info-list">'),n.createDoctorStr(e.accurateDoctorList,a),a.push("</ul>")}if(e.doctorList&&e.doctorList.length>0)a.push('<ul class="doctor-info-list" id="doctor-info-list">'),a.push('<h4 style="text-align: left;">为您推荐同科室的其他医生</h4>'),n.createDoctorStr(e.doctorList,a),a.push("</ul>");a.push('<div class="pagination-x pull-right">'),a.push('<span class="pagers"></span>'),a.push("</div>"),t.html(a.join(""));var r=parseInt(i/10);if(0==r)$("#doctor-info-list").find(".doctor-info-single").eq(-1).css("border-bottom-color","#fff")},viewHospitalList:function(e,t,n){var i=require("common/js/config"),a=[];if($("#hos_total").html(e.total),e.currentArea)$("#hos_region").html(e.currentArea);else $("#hos_region").html("");var r=e.hospitalList?e.hospitalList.length:0;if(0>=r)t.hide(),t.parents(".hospital-list").find(".pagination-x").hide(),$(".hospital-empty").show();else{$(".hospital-empty").hide(),t.show(),t.parents(".hospital-list").find(".pagination-x").show();for(var o=0;r>o;o++){if(a.push('<li class="hospital-info-li">'),a.push('<div class="hospital-info">'),a.push('<div class="hospital-pic"><a target="_blank" href="'+e.hospitalList[o].link+'"><img class="fl" src="'+e.hospitalList[o].logo+'"></a></div>'),a.push('<div class="hospital-introduces fl">'),a.push('<div class="introduces-title"><a target="_blank" href="'+e.hospitalList[o].link+'">'+e.hospitalList[o].name+"</a>"),e.hospitalList[o].level)a.push('<span class="hospital-sign">'+e.hospitalList[o].level+"</span>");if(1==e.hospitalList[o].insurance)a.push('<span class="hospital-health">医保</span>');a.push("</div>"),a.push('<p class="grade-star">');for(var s=.5;10>s;){if(e.hospitalList[o].grade>s+1)a.push('<i class="star-right star-light star-fixed"></i>');else if(e.hospitalList[o].grade>s)a.push('<i class="star-right star-gray-light star-fixed"></i>');else a.push('<i class="star-right star-gray star-fixed"></i>');s+=2}if(a.push('<span class="grade-text '+("0.0"==e.hospitalList[o].grade?"ys-search-lbl-noscore":"")+'">'+e.hospitalList[o].grade+"</span>"),e.hospitalList[o].commentHref&&e.hospitalList[o].commentNum)a.push('<span class="comment-text">( <a target="_blank" href="'+e.hospitalList[o].commentHref+'">'+e.hospitalList[o].commentNum+"患者评论 </a>)</span>");else if(e.hospitalList[o].commentNum)a.push('<span class="comment-text">( <i>'+e.hospitalList[o].commentNum+"患者评论 </i>)</span>");if(a.push("</p>"),a.push("<label>有优质医生<span>"+e.hospitalList[o].doctorNum+"</span>人<span> | </span>完成服务<span>"+e.hospitalList[o].serviceNum+"</span>次</label>"),a.push("<table cellSpacing=0 cellPadding=0>"),a.push("<tr>"),a.push('<td valign="top" class="first-child">医院地址: </td>'),a.push('<td class="info-pos last-child"><p class="address">'+i.subTitle(e.hospitalList[o].address,26)+'</p><a href="'+e.hospitalList[o].routeLink+'" class="marker" target="_blank"><i class="fa fa-map-marker"></i>查看地图</a>'),a.push("</td></tr>"),a.push("</table>"),a.push("</div>"),a.push('<div class="server-but fr">'),e.hospitalList[o].serviceConsult)a.push('<p><a href="'+e.hospitalList[o].serviceConsult+'" target="_blank">咨询医生</a></p>');if(e.hospitalList[o].serviceOrder)a.push('<p><a href="'+e.hospitalList[o].serviceOrder+'" target="_blank">预约挂号</a></p>');a.push("</div>"),a.push("</div>"),a.push("</li>")}t.html(a.join(""));var l=parseInt(r/10);if(0==l)$("#hospital-list-ul").find("li").eq(-1).css("border-color","#fff")}},pageEvent:function(){$(".pagination-x-list").find("li").length;$(".pagination-x-list").delegate("li","click",function(){if(0!==$(this).index()||$(this).index()!==$(".pagination-x-list").find("li").last().index())$("#fastTop").show()})},relativeHos:function(e){var t=this,n=[],i=e.hospitalList?e.hospitalList.length:0;if(!(0>=i)){$("#excel-hos-div").show();for(var a=0;i>a;a++){if(a%4==3)n.push('<li class="hospital-detail content-last">');else n.push('<li class="hospital-detail">');n.push('<a href="'+e.hospitalList[a].link+'" target="_blank"><img src="'+e.hospitalList[a].logo+'" width="230" height="120"></a>'),n.push('<p class="hospital-name">'),n.push('<a href="'+e.hospitalList[a].link+'" target="_blank" title="'+e.hospitalList[a].name+'" target="_blank"><span class="span-name">'+e.hospitalList[a].name+"</span></a>");for(var r=.5;10>r;){if(e.hospitalList[a].grade>r+1)n.push('<i class="star-right star-light star-fixed"></i>');else if(e.hospitalList[a].grade>r)n.push('<i class="star-right star-gray-light star-fixed"></i>');else n.push('<i class="star-right star-gray star-fixed"></i>');r+=2}if(n.push('<span class="grade-text '+("0.0"==e.hospitalList[a].grade?"ys-search-lbl-noscore":"")+'">'+e.hospitalList[a].grade+"</span>"),n.push('<label class="hospital-grade">'),e.hospitalList[a].level)n.push(' <span class="grade">'+e.hospitalList[a].level+"</span>");if(1==e.hospitalList[a].insurance)n.push('<span class="corpt">医保</span>');n.push("</label></p>"),n.push('<p class="appointent_total"><label class="label-left">'+e.hospitalList[a].doctorNum+'位可挂号医生</label><label class="label-right"><span>'+e.hospitalList[a].serveNum+"</span>人成功预约</label></p><li>")}$("#doctor_content").append(n.join(""))}else if($("#excel-hos-div").remove(),t.excelDoctorList.length<=0)$("#more-excel").remove()},areaEvent:function(){$(".city-index span").on("click",function(){$(".city-list div").hide().eq($(".city-index span").removeClass("border-bottom3px").addClass("border-bottom1px").index($(this).attr("class","border-bottom3px"))).show()}),$(".area-border").on("mouseenter",function(){$(this).find(".city-index").find("span").attr("class","border-bottom1px"),$(this).find(".city-list").find("div").hide();var e=$(this).find(".city-index").attr("data-index");$(this).find(".city-index").find("span").eq(e).attr("class","border-bottom3px"),$(this).find(".city-list").find("div").eq(e).show(),$(this).css("border-color","#eaeaea").find(".select-city").show()}).on("mouseleave",function(){$(this).css("border-color","#ffffff").find(".select-city").hide()})},getFilterData:function(e){var t={};if(t.page=e,paramdata=$("#header").data("paramdata"),paramdata)for(var n in paramdata)t[n]=paramdata[n];return t},backTop:function(){var e=$(".footer-box").height();$(window).scroll(function(){var t=$(this).scrollTop(),n=$(document).height(),i=$(this).height();if($(window).scrollTop()>30)$("#feedback").show();else if($(window).scrollTop()<30)$("#feedback").hide();var a=n-(t+i);if(e>=a)$("#feedback").css("bottom",e-a+15+"px");else $("#feedback").css("bottom","20px")}),$("#back-top").click(function(){return $("html,body").animate({scrollTop:"0px"},500),$(this).blur(),!1}),$("#back").click(function(){$(this).blur()}),$("#feedback").find("img").mouseenter(function(){$(this).attr("src",$(this).data("srchover"))}),$("#feedback").find("img").mouseleave(function(){$(this).attr("src",$(this).data("src"))})}}});